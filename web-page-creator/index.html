<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Page Creator</title>
    <style>
        /* Modern CSS Reset and Global Styles */
        :root {
            --primary: #4361ee;
            --primary-hover: #3a56d4;
            --secondary: #f72585;
            --text-dark: #2b2d42;
            --text-light: #8d99ae;
            --bg-light: #f8f9fa;
            --bg-white: #ffffff;
            --border-light: #e9ecef;
            --success: #38b000;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
            --radius: 12px;
            --radius-sm: 8px;
            --font-main: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--bg-light);
            color: var(--text-dark);
            font-family: var(--font-main);
            line-height: 1.6;
            padding: 0;
            margin: 0;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 0.5em;
        }

        /* Layout */
        .container {
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
            padding: 0;
        }

        /* Card Styling */
        .card {
            background-color: var(--bg-white);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 2rem;
            transition: var(--transition);
        }

        .card:hover {
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .card-title {
            margin: 0;
            font-size: 1.5rem;
            color: var(--primary);
        }

        .card-body {
            padding: 2rem;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 0rem;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-dark);
            font-size: 1rem;
        }

        textarea, select {
            width: 100%;
            padding: 1rem;
            border: 1px solid var(--border-light);
            border-radius: var(--radius-sm);
            font-size: 1rem;
            font-family: inherit;
            background-color: var(--bg-white);
            color: var(--text-dark);
            transition: var(--transition);
        }

        textarea {
            height: 180px;
            resize: vertical;
        }

        textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.15);
        }

        /* Button Styling */
        .btn {
            display: inline-block;
            font-weight: 600;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            user-select: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            border-radius: var(--radius-sm);
            transition: var(--transition);
            border: none;
            cursor: pointer;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        .btn-group {
            display: flex;
            gap: 0;
            width: 100%;
        }

        .btn-group .btn {
            flex: 1;
            border-radius: 0;
        }

        .btn-group .btn:first-child {
            border-top-left-radius: var(--radius-sm);
            border-bottom-left-radius: var(--radius-sm);
        }

        .btn-group .btn:last-child {
            border-top-right-radius: var(--radius-sm);
            border-bottom-right-radius: var(--radius-sm);
        }

        /* Status Area */
        .status {
            padding: 1.5rem;
            border-radius: var(--radius-sm);
            margin: 1.5rem 0;
            background-color: var(--bg-light);
            border-left: 4px solid var(--primary);
            display: flex;
            align-items: center;
        }

        .status-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
            color: var(--primary);
        }

        .status-text {
            flex: 1;
        }

        /* Preview Area */
        .preview-title {
            margin: 2rem 0 1rem 0;
            display: flex;
            align-items: center;
            font-size: 1.25rem;
        }

        .preview-title i {
            margin-right: 0.5rem;
        }

        .preview-frame {
            width: 100%;
            height: 600px;
            border: 1px solid var(--border-light);
            border-radius: var(--radius-sm);
            overflow: hidden;
        }

        /* Info Footer */
        .info-footer {
            margin-top: 3rem;
            padding: 2rem;
            border-top: 1px solid var(--border-light);
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* Loading Animation */
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }

        .loading {
            animation: pulse 1.5s infinite;
        }

        /* Responsive Design */
        @media screen and (max-width: 991px) {
            .container {
                padding: 0rem;
            }
            
            .card-header, .card-body {
                padding: 1.5rem;
            }
        }
        
        @media screen and (max-width: 768px) {
            .container {
                padding: 0rem;
            }
            
            .card-header, .card-body {
                padding: 1.25rem;
            }
            
            .preview-frame {
                height: 450px;
            }
            
            .card-title {
                font-size: 1.25rem;
            }
        }
        
        @media screen and (max-width: 576px) {
            .container {
                padding: 0rem;
            }
            
            .card-header, .card-body {
                padding: 1rem;
            }
            
            .preview-frame {
                height: 350px;
            }
            
            textarea {
                height: 150px;
            }
            
            .btn {
                padding: 0.625rem 1.25rem;
            }
        }

        /* Theme Toggle */
        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.25rem;
        }

        /* Dark Mode */
        .dark-mode {
            --primary: #4cc9f0;
            --primary-hover: #3db8df;
            --secondary: #f72585;
            --text-dark: #e9ecef;
            --text-light: #adb5bd;
            --bg-light: #1a1a2e;
            --bg-white: #16213e;
            --border-light: #0f3460;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1 class="card-title">Web Page Creator</h1>
            </div>
            
            <div class="card-body">
                <form id="generator-form">

<div class="form-group">
    <label for="example-web-page-idea">
        <i class="fas fa-image"></i> Web Page Idea and/or Information
    </label>
    <div class="btn-group">
        <button type="button" onclick="exampleWebPageIdea();" id="example-web-page-idea-button" class="btn btn-primary">
            <i class="fas fa-upload"></i> Example Idea
        </button>
        <button type="button" onclick="window.open('https://public-web-pages.github.io/custom-web-page/web-pages/4820571f321fcbe6a2d964b9075fa76072d0fa91060719d8efc17ec059a707e1.html', '_blank');" id="example-web-page-button" class="btn btn-primary">
            <i class="fas fa-trash"></i> Example Web Page
        </button>
    </div>
</div>


                        <BR>
                        <textarea id="user-message" placeholder="Describe your web page idea here..."></textarea>

                        <!-- Add this right after the textarea in your form -->
<div class="form-group">
    <label for="image-upload">
        <i class="fas fa-image"></i> Upload Images (It may take some time for images to be displayed on the web page)
    </label>
    <input type="file" id="image-upload" multiple accept="image/*" style="display: none;">
    <div class="btn-group">
        <button type="button" id="upload-button" class="btn btn-primary">
            <i class="fas fa-upload"></i> Select Images
        </button>
        <button type="button" id="clear-images" class="btn btn-primary">
            <i class="fas fa-trash"></i> Clear Images
        </button>
    </div>
    <div id="image-preview" style="margin-top: 1rem; display: flex; flex-wrap: wrap; gap: 0.5rem;"></div>
</div>


<div class="form-group">
    <label for="favicon-upload">
        <i class="fas fa-image"></i> Upload Favicon (It may take some time for images to be displayed on the web page)
    </label>
    <input type="file" id="favicon-upload" accept="image/*" style="display: none;">
    <div class="btn-group">
        <button type="button" id="favicon-upload-button" class="btn btn-primary">
            <i class="fas fa-upload"></i> Select Favicon
        </button>
        <button type="button" id="clear-favicon" class="btn btn-primary">
            <i class="fas fa-trash"></i> Clear Favicon
        </button>
    </div>
    <div id="favicon-preview" style="margin-top: 1rem; display: flex; flex-wrap: wrap; gap: 0.5rem;"></div>
</div>



<script>
    // Favicon Upload Functionality
    document.getElementById('favicon-upload-button').addEventListener('click', () => {
        document.getElementById('favicon-upload').click();
    });
    
    document.getElementById('favicon-upload').addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;
        
        const responseText = document.getElementById('response-text');
        responseText.innerHTML = '<div class="status-icon"><i class="fas fa-spinner fa-spin"></i></div><div class="status-text">Uploading favicon...</div>';
        
        const faviconPreview = document.getElementById('favicon-preview');
        faviconPreview.innerHTML = '';
        
        // Show preview
        const reader = new FileReader();
        reader.onload = (e) => {
            const img = document.createElement('img');
            img.src = e.target.result;
            img.style.maxWidth = '64px';
            img.style.maxHeight = '64px';
            img.style.borderRadius = '4px';
            faviconPreview.appendChild(img);
        };
        reader.readAsDataURL(file);
        
        // Upload to server
        try {
            const formData = new FormData();
            formData.append('image', file);
            
            const response = await fetch('https://image-uploader-and-analyzer.small-recipe-9582.workers.dev/', {
                method: 'POST',
                body: formData
            });
            
            if (!response.ok) throw new Error('Favicon upload failed');
            
            const data = await response.json();
            if (data.results && data.results[0].success) {
                const faviconUrl = data.results[0].url;
                
                // Update textarea with favicon URL
                const textarea = document.getElementById('user-message');
                const faviconText = `\n\n\`\`\`Favicon, also known as a shortcut icon, website icon, tab icon, URL icon, or bookmark icon

I am interested in using this image URL as a favicon, also known as a shortcut icon, website icon, tab icon, URL icon, or bookmark icon: "${faviconUrl}"

\`\`\``;
                textarea.value += faviconText;
                
                responseText.innerHTML = '<div class="status-icon"><i class="fas fa-check-circle"></i></div><div class="status-text">Favicon uploaded successfully!</div>';
            } else {
                throw new Error('Favicon upload processing failed');
            }
        } catch (error) {
            console.error('Error uploading favicon:', error);
            responseText.innerHTML = `<div class="status-icon"><i class="fas fa-exclamation-circle"></i></div><div class="status-text">Favicon upload failed: ${error.message}</div>`;
        }
    });
    
    // Clear favicon button
    document.getElementById('clear-favicon').addEventListener('click', () => {
        document.getElementById('favicon-upload').value = '';
        document.getElementById('favicon-preview').innerHTML = '';
        
        // Remove favicon text from textarea if present
        const textarea = document.getElementById('user-message');
        const faviconRegex = /\n\nI am interested in using this image URL as a Favicon: .+/g;
        textarea.value = textarea.value.replace(faviconRegex, '');
    });
    </script>

                    
                    <script>

                        // Image Upload Functionality
document.getElementById('upload-button').addEventListener('click', () => {
    document.getElementById('image-upload').click();
});

document.getElementById('image-upload').addEventListener('change', async (e) => {
        const files = e.target.files;
        if (files.length === 0) return;
        
        const responseText = document.getElementById('response-text');
        responseText.innerHTML = '<div class="status-icon"><i class="fas fa-spinner fa-spin"></i></div><div class="status-text">Uploading and analyzing images...</div>';
        
        const imagePreview = document.getElementById('image-preview');
        imagePreview.innerHTML = '';
        
        let uploadedData = [];
        
        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            
            // Show preview
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = document.createElement('img');
                img.src = e.target.result;
                img.style.maxWidth = '100px';
                img.style.maxHeight = '100px';
                img.style.borderRadius = '4px';
                imagePreview.appendChild(img);
            };
            reader.readAsDataURL(file);
            
            // Upload to server and analyze
            try {
                const formData = new FormData();
                formData.append('image', file);
                
                const response = await fetch('https://image-uploader-and-analyzer.small-recipe-9582.workers.dev/', {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) throw new Error('Upload failed');
                
                const data = await response.json();
                if (data.results && data.results[0].success) {
                    uploadedData.push({
                        url: data.results[0].url,
                        description: data.results[0].aiResponse?.Image_Description || "No description available"
                    });
                }
            } catch (error) {
                console.error('Error uploading image:', error);
            }
        }
        
        // Update textarea with image URLs and descriptions
        if (uploadedData.length > 0) {
            const textarea = document.getElementById('user-message');

            var imageText = '';

            if (uploadedData.length > 1) {
                imageText = `\n\n\`\`\`Images in the Web Page

I am interested in using these images.\n\n`;
            }
            else {
                imageText = `\n\n\`\`\`Image in the Web Page

I am interested in using this image.\n\n`;
            }
            uploadedData.forEach((item, index) => {
                imageText += `Image URL ${index + 1}: "${item.url}" (Image Description, according to AI: ${item.description})\n\n`;
            });
            
            imageText += `\`\`\`
`;
            textarea.value += imageText;
            responseText.innerHTML = '<div class="status-icon"><i class="fas fa-check-circle"></i></div><div class="status-text">Images uploaded and analyzed successfully!</div>';
        } else {
            responseText.innerHTML = '<div class="status-icon"><i class="fas fa-exclamation-circle"></i></div><div class="status-text">No images were uploaded successfully.</div>';
        }
    });



// Clear images button
document.getElementById('clear-images').addEventListener('click', () => {
    document.getElementById('image-upload').value = '';
    document.getElementById('image-preview').innerHTML = '';
});

                        function exampleWebPageIdea() {
                            document.getElementById('user-message').value = `Andrew Outreach Orphanage

Location: Bugiri district 
P.o Box 78 (U)
Tell: +256709401422

It was established in 2016 by the CEO KIiza Abel

Reminder the district changed post office number from 37 to 78

\`\`\`Images in the Web Page

I am interested in using these images.

Image URL 1: "https://public-web-pages.github.io/custom-web-page/images/700784ad8554f62c.jpg" (Image Description, according to AI: A group of children are standing together in a circle, looking up at the camera. They are all smiling and appear to be happy. The children are all wearing casual clothing, such as t-shirts and tank tops, and some of them have their arms around each other. The background is a dirt ground, suggesting that the photo was taken outdoors in a rural or natural setting. Overall, the image conveys a sense of joy and camaraderie among the children.)

Image URL 2: "https://public-web-pages.github.io/custom-web-page/images/49f0b5acf418b895.jpg" (Image Description, according to AI: A group of young children, all with dark skin and short hair, are gathered together and looking up at the camera. They are all wearing casual clothing, such as t-shirts and button-down shirts, and some of them have their hands raised in the air. The background is out of focus, but it appears to be a dirt or sandy area.)

Image URL 3: "https://public-web-pages.github.io/custom-web-page/images/7ae6586126fc5fe4.jpg" (Image Description, according to AI: A registration certificate for a community development project in Uganda, featuring a government seal and stamps, with text describing the project's purpose and details.)

Image URL 4: "https://public-web-pages.github.io/custom-web-page/images/000012cfafa4a1a5.jpg" (Image Description, according to AI: A group of children gathered around a table with watermelons and bananas, with some of them raising their hands in the air.)

Image URL 5: "https://public-web-pages.github.io/custom-web-page/images/3a309159f07b1c4b.jpg" (Image Description, according to AI: A young boy holding a yellow sign that reads 'SUPPORT US WITH A DAILY MEAL' in red letters. He is surrounded by other children, some of whom are also holding signs or bottles. The background is blurry but appears to be outdoors, possibly in a park or field. The overall atmosphere suggests a charity event or fundraiser for a good cause.)

Image URL 6: "https://public-web-pages.github.io/custom-web-page/images/c46d299ea855c48d.jpg" (Image Description, according to AI: A young boy is holding a large bunch of bananas in front of a group of children.)

Image URL 7: "https://public-web-pages.github.io/custom-web-page/images/7f41ac7a6b6b6534.jpg" (Image Description, according to AI: A young boy is holding a large crucifix in front of his chest. He is wearing a red and gray striped shirt and a green beaded necklace. In the background, there are several other children sitting on the ground, but they are out of focus.)

\`\`\`

\`\`\`Favicon, also known as a shortcut icon, website icon, tab icon, URL icon, or bookmark icon

I am interested in using this image URL as a favicon, also known as a shortcut icon, website icon, tab icon, URL icon, or bookmark icon: "https://public-web-pages.github.io/custom-web-page/images/3a309159f07b1c4b.jpg"

\`\`\`
`;
                        }
                    </script>
                    
                    <div class="form-group">
                        <label for="modelSelect">
                            <i class="fas fa-robot"></i> Select AI Model
                        </label>
                        <select id="modelSelect">
                            <!-- Options will be populated by JavaScript -->
                        </select>
                    </div>
                    <BR>
                    <div class="form-group">
                        <label for="webPageTemplate">
                            <i class="fas fa-robot"></i> Select Web Page Template
                        </label>
                        <select id="webPageTemplate">
                            <option value="timeless">Timeless</option>
                            <option value="modern">Modern</option>
                            <option value="experimental">Experimental</option>
                            <option value="lots_of_content">Lots of Content</option>
                            <option value="animations">Animations</option>
                        </select>
                    </div>

                    <BR>

                    <button type="button" id="submit-button" class="btn btn-primary btn-block">
                        <i class="fas fa-magic"></i> Create Web Page
                    </button>
                </form>
                
                <div id="response-text" class="status">
                    <div class="status-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <div class="status-text">Ready for creation...</div>
                </div>
                
                <div id="htmlFileButtons" class="btn-group">
                    <button id="download" class="btn btn-primary" onclick="downloadHTML(sessionStorage.getItem('FILE_NAME'), sessionStorage.getItem('HTML_FILE'));">
                        <i class="fas fa-download"></i> Download HTML File
                    </button>
                    <button id="openInNewTab" class="btn btn-primary" onclick="openTab(sessionStorage.getItem('HTML_FILE'));">
                        <i class="fas fa-external-link-alt"></i> Open In New Tab
                    </button>
                </div>

                <BR>
                
                <!-- Add this new button below the existing button group -->
                <button id="uploadToInternet" class="btn btn-primary btn-block" onclick="uploadHTMLToInternet();">
                    <i class="fas fa-cloud-upload-alt"></i> Upload HTML File to the Internet
                </button>
                
                <h2 class="preview-title">
                    <i class="fas fa-eye"></i> Preview
                </h2>
                <iframe id="myIframe" class="preview-frame" title="Web Page Preview"></iframe>

                <h2 class="preview-title">
                    <i class="fas fa-eye"></i> HTML Code
                </h2>
                <textarea id="HTMLCode" readonly></textarea>
<button class="btn btn-primary btn-block" onclick="copyToClipboard()">Copy HTML Code</button>

<script>
function copyToClipboard() {
    var textarea = document.getElementById("HTMLCode");
    navigator.clipboard.writeText(textarea.value).then(() => {
        function showToast(message) {
    let toast = document.createElement("div");
    toast.textContent = message;
    toast.style.position = "fixed";
    toast.style.bottom = "20px";
    toast.style.left = "50%";
    toast.style.transform = "translateX(-50%)";
    toast.style.background = "rgba(0, 0, 0, 0.8)";
    toast.style.color = "#fff";
    toast.style.padding = "10px 20px";
    toast.style.borderRadius = "5px";
    toast.style.fontSize = "14px";
    toast.style.zIndex = "1000";
    toast.style.opacity = "0";
    toast.style.transition = "opacity 0.3s ease-in-out";

    document.body.appendChild(toast);

    // Fade in
    setTimeout(() => {
        toast.style.opacity = "1";
    }, 10);

    // Fade out and remove
    setTimeout(() => {
        toast.style.opacity = "0";
        setTimeout(() => {
            toast.remove();
        }, 300);
    }, 2000); // Adjust timing as needed
}

// Example usage:
showToast("Copied to clipboard!");

    }).catch(err => {
        console.error("Error copying text: ", err);
    });
}
</script>
            </div>
        </div>
        
        <div id="informationFooter" class="info-footer"></div>
    </div>


    <script>

async function uploadHTMLToInternet() {
    const responseText = document.getElementById('response-text');
    const htmlContent = sessionStorage.getItem('HTML_FILE');
    
    if (!htmlContent) {
        responseText.innerHTML = '<div class="status-icon"><i class="fas fa-exclamation-circle"></i></div><div class="status-text">No HTML content to upload. Please create a web page first.</div>';
        return;
    }
    
    try {
        responseText.innerHTML = '<div class="status-icon"><i class="fas fa-spinner fa-spin"></i></div><div class="status-text">Uploading HTML file to the internet...</div>';
        
        const response = await fetch('https://html-file-uploader.small-recipe-9582.workers.dev/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `html=${encodeURIComponent(htmlContent)}`
        });
        
        if (!response.ok) {
            throw new Error(`Upload failed: ${response.statusText}`);
        }
        
        const data = await response.json();
        
        if (data.success && data.url) {
            responseText.innerHTML = `
                <div class="status-icon"><i class="fas fa-check-circle"></i></div>
                <div class="status-text">
                    File uploaded successfully! It may take some time for this file to be deployed.<br>
                    URL: <a href="${data.url}" target="_blank">${data.url}</a>
                </div>
            `;
            
            // Store the URL in sessionStorage for potential future use
            sessionStorage.setItem('UPLOADED_URL', data.url);
        } else {
            throw new Error(data.message || 'Unknown error occurred during upload');
        }
    } catch (error) {
        responseText.innerHTML = `
            <div class="status-icon"><i class="fas fa-exclamation-circle"></i></div>
            <div class="status-text">
                Upload failed: ${error.message}
            </div>
        `;
    }
}

        const apiKey = "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";
        const apiUrl = "https://proxy.small-recipe-9582.workers.dev/";
        const MAX_RETRIES = 6;
        const RETRY_DELAY = 1000; // 1 second

        async function makeApiRequest(retryCount = 0) {

            var webPageTemplateBase = `I am interested in you creating a web page.

I am interested in a complete web page in a single HTML file.

I am interested in using vanilla HTML and vanilla CSS

I am interested in having full ownership of this code, and I am interested in releasing it into the public domain.

I am interested in using well established code principles and designs.

I am interested in you filling this web page with truthful and relevant content.

I am interested in content that is acceptable to a Christian audience.

I am interested in this web page being beautiful.

I am interested in this web page being responsive.

I am interested in this web page being usable in a production environment.

I am interested in the content on this web page being fact checked and accurate. This is very important. I am interested in content that is verified.

I would like a very strong bias for caution and perfect information.

Please do not display Scripture or quote Scripture within the web page at this time, only link to Scripture @ https://bible.usccb.org/

I would like you to always and only refer to Scripture by referring to content at this URL https://bible.usccb.org/bible/

Please do not put Scripture text, Verse text, or Passage text in the chat.

Format: https://bible.usccb.org/bible/ + chapter + starting_verse

For example, the URL for Genesis, Chapter 1, Verse 5 would be "https://bible.usccb.org/bible/genesis/1?5"

Please refer to the URLs after this sentence when linking to Scripture.

Always provide a link to Scripture when referring to Scripture.

\`\`\`https://bible.usccb.org links

Matthew: https://bible.usccb.org/bible/matthew/0
Mark: https://bible.usccb.org/bible/mark/0
Luke: https://bible.usccb.org/bible/luke/0
John: https://bible.usccb.org/bible/john/0

Acts of the Apostles: https://bible.usccb.org/bible/acts/0

Romans: https://bible.usccb.org/bible/romans/0
1 Corinthians: https://bible.usccb.org/bible/1corinthians/0
2 Corinthians: https://bible.usccb.org/bible/2corinthians/0
Galatians: https://bible.usccb.org/bible/galatians/0
Ephesians: https://bible.usccb.org/bible/ephesians/0
Philippians: https://bible.usccb.org/bible/philippians/0
Colossians: https://bible.usccb.org/bible/colossians/0
1 Thessalonians: https://bible.usccb.org/bible/1thessalonians/0
2 Thessalonians: https://bible.usccb.org/bible/2thessalonians/1
1 Timothy: https://bible.usccb.org/bible/1timothy/0
2 Timothy: https://bible.usccb.org/bible/2timothy/0
Titus: https://bible.usccb.org/bible/titus/0
Philemon: https://bible.usccb.org/bible/philemon/0
Hebrews: https://bible.usccb.org/bible/hebrews/0

James: https://bible.usccb.org/bible/james/0
1 Peter: https://bible.usccb.org/bible/1peter/0
2 Peter: https://bible.usccb.org/bible/2peter/0
1 John: https://bible.usccb.org/bible/1john/0
2 John: https://bible.usccb.org/bible/2john/1
3 John: https://bible.usccb.org/bible/3john/1
Jude: https://bible.usccb.org/bible/jude/0
Revelation: https://bible.usccb.org/bible/revelation/0

\`\`\`

I am interested in requiring that this HTML code be included in the web page at the bottom of the web page: \`\`\`HTML
<div id="informationFooter" style="padding-left: 4em; padding-right: 4em;"></div>
\`\`\`

I am interested in requiring that this external Javascript file be run on this web page after the informationFooter: "https://www.avemariacloud.com/generic-loader.js"

The Javascript code that I referenced earlier will populate the “informationFooter” div with some information that I have.

I am interested in "https://www.avemariacloud.com/generic-loader.js" being the only JS code on the page.

I require that "<div id="informationFooter" style="padding-left: 4em; padding-right: 4em;"></div>" and "https://avemariacloud.com/generic-loader.js" be on this web page.

Please respond in JSON with the labels HTML_FILE and FILE_NAME 

Please place only HTML code within the label: "HTML_FILE"

Please ensure that the FILE_NAME ends in .html`;

            const webPageTemplate = {

            "timeless": `I am interested in this web page having a safe and timeless design.`,
            "modern": `I am interested in this web page having a modern design.`,
            "experimental": `I am interested in this web page having an experimental design.`,
            "lots_of_content": `I am interested in this web page having a lot of content.`,
            "animations": `I am interested in this web page having animations.`

            };

            const systemMessage = webPageTemplateBase + `

` + webPageTemplate[document.getElementById("webPageTemplate").value];

            console.log(systemMessage);

            const userMessage = "Web Page Idea and/Or Information: " + document.getElementById('user-message').value;
            const selectedModel = document.getElementById('modelSelect').value;
            const requestJson = true;
            const responseText = document.getElementById('response-text');
            
            try {

                responseText.innerHTML = "Loading...";
                
                const requestBody = {
                    model: selectedModel,
                    messages: [
                        { role: 'system', content: systemMessage },
                        { role: 'user', content: userMessage }
                    ]
                };

                if (requestJson) {
                    requestBody.response_format = {
                        type: "json_object"
                    };
                }

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.statusText}`);
                }

                const data = await response.json();
                const content = data.choices[0]?.message?.content || "No response received.";

                if (requestJson) {
                    try {
                        const jsonContent = JSON.parse(content);
                        if (jsonContent.HTML_FILE) {
                            
                          sessionStorage.setItem("HTML_FILE", jsonContent.HTML_FILE);

                          sessionStorage.setItem("FILE_NAME", jsonContent.FILE_NAME);

                          document.getElementById("HTMLCode").innerHTML = jsonContent.HTML_FILE;
                          
                          console.log(jsonContent.FILE_NAME);
                          console.log(jsonContent.HTML_FILE);

                          const blob = new Blob([jsonContent.HTML_FILE], { type: 'text/html' });
                          const iframe = document.getElementById('myIframe');
                          iframe.src = URL.createObjectURL(blob);

                          responseText.innerHTML = "Ready for input...";

                          scrollToId("myIframe");
                            
                        } else {
                            responseText.style.display = 'block';

                            throw new Error(`API Error: ${response.statusText}`);
                            //responseText.innerHTML = JSON.stringify(jsonContent, null, 2);
                        }
                    } catch (e) {
                        responseText.style.display = 'block';

                        throw new Error(`API Error: ${response.statusText}`);
                        //responseText.innerHTML = content;
                    }
                } else {
                    responseText.style.display = 'block';

                    throw new Error(`API Error: ${response.statusText}`);
                    //responseText.innerHTML = content;
                }
            } catch (error) {
                if (retryCount < MAX_RETRIES) {
                    responseText.innerHTML = `An error possibly occurred. Retrying... (Attempt ${retryCount + 1}/${MAX_RETRIES})`;
                    await new Promise(resolve => setTimeout(resolve, RETRY_DELAY));
                    return makeApiRequest(retryCount + 1);
                } else {
                    responseText.innerHTML = `Error after ${MAX_RETRIES} attempts: ${error.message}`;
                }
            }
        }

        document.getElementById('submit-button').addEventListener('click', () => makeApiRequest());

        function openTab(HTML_FILE) {
          const newTab = window.open('', '_blank'); // Open a blank tab
          newTab.document.open(); // Open the document for writing
          newTab.document.write(HTML_FILE); // Write the HTML content
          newTab.document.close(); // Close the document stream
        }

        function scrollToId(id) {
    const element = document.getElementById(id);
    if (element) {
        element.scrollIntoView({ behavior: "smooth" });
    }
}

function downloadHTML(filename, content) {
    const blob = new Blob([content], { type: "text/html" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}

    </script>


    
    <script src="https://avemariacloud.com/generic-loader.js"></script>



    
    <div id="chatbot-container" style="position: fixed; bottom: 0; right: 0; width: 350px; z-index: 1000; margin-bottom: 0;">
        <div id="chatbot-header" style="background-color: var(--primary); color: white; padding: 12px; border-top-left-radius: var(--radius-sm); border-top-right-radius: var(--radius-sm); cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
            <span>AI Web Page Assistant</span>
            <span id="chatbot-toggle">+</span>
        </div>
        <div id="chatbot-body" style="background-color: var(--bg-white); height: 400px; display: none; flex-direction: column; border-left: 1px solid var(--border-light); border-right: 1px solid var(--border-light);">
            <div id="chat-messages" style="flex: 1; overflow-y: auto; padding: 12px;"></div>
            <div style="padding: 12px; border-top: 1px solid var(--border-light);">
                <textarea id="chat-input" placeholder="Type your message here..." style="width: 100%; padding: 8px; border: 1px solid var(--border-light); border-radius: var(--radius-sm); margin-bottom: 8px; resize: none;"></textarea>
                <button id="chat-send" class="btn btn-primary" style="width: 100%;">Send</button>
            </div>
        </div>
    </div>


    <script>

// Chatbot functionality
const chatbotContainer = document.getElementById('chatbot-container');
const chatbotHeader = document.getElementById('chatbot-header');
const chatbotBody = document.getElementById('chatbot-body');
const chatMessages = document.getElementById('chat-messages');
const chatInput = document.getElementById('chat-input');
const chatSend = document.getElementById('chat-send');
const chatbotToggle = document.getElementById('chatbot-toggle');

// Set initial state to minimized
let isChatMinimized = true;
chatbotBody.style.display = 'none';
chatbotToggle.textContent = '+';

// Update the container styling to be positioned at the bottom right with no gap
chatbotContainer.style.position = 'fixed';
chatbotContainer.style.bottom = '0';
chatbotContainer.style.right = '0';
chatbotContainer.style.width = '350px';
chatbotContainer.style.zIndex = '1000';
chatbotContainer.style.marginBottom = '0';

// Toggle chatbot visibility when clicking anywhere on the header
chatbotHeader.addEventListener('click', () => {
    isChatMinimized = !isChatMinimized;
    if (isChatMinimized) {
        chatbotBody.style.display = 'none';
        chatbotToggle.textContent = '+';
    } else {
        chatbotBody.style.display = 'flex';
        chatbotToggle.textContent = '−';
    }
});

// Send message function
async function sendChatMessage() {
    const message = chatInput.value.trim();
    if (!message) return;
    
    // Add user message to chat
    addChatMessage('user', message);
    chatInput.value = '';
    
    // Show loading message
    const loadingId = 'loading-' + Date.now();
    addChatMessage('assistant', 'Thinking...', loadingId);
    
    try {
        // Get ONLY the current HTML content (most recent version)
        const currentHtml = sessionStorage.getItem('HTML_FILE') || '';
        
        // Prepare the API request with proper JSON structure
        const requestBody = {
            model: document.getElementById('modelSelect').value,
            messages: [
                { 
                    role: 'system', 
                    content: `You are an AI assistant that helps modify HTML web pages. 
                    The user will provide their current HTML code and a request for changes.
                    When responding:
                    - If the user wants code changes, respond with a JSON object containing the complete updated HTML code in the "HTML_code" field.
                    - If the user is just asking a question or having a conversation, respond with a JSON object containing your message in the "chat_message" field.
                    - Always use either "chat_message" or "HTML_code" as your response labels.
                    - When providing HTML code, include the complete updated HTML document, not just the changed portions.`
                },
                {
                    role: 'user',
                    content: JSON.stringify({
                        current_html: currentHtml,
                        user_message: message
                    })
                }
            ],
            response_format: { type: "json_object" }
        };
        
        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${apiKey}`
            },
            body: JSON.stringify(requestBody)
        });
        
        if (!response.ok) throw new Error('API request failed');
        
        const data = await response.json();
        const content = data.choices[0]?.message?.content;
        
        // Remove loading message
        document.getElementById(loadingId)?.remove();
        
        try {
            const jsonResponse = JSON.parse(content);
            
            if (jsonResponse.HTML_code) {
                // Update the HTML file
                sessionStorage.setItem('HTML_FILE', jsonResponse.HTML_code);
                document.getElementById('HTMLCode').value = jsonResponse.HTML_code;
                
                // Update the preview iframe
                const blob = new Blob([jsonResponse.HTML_code], { type: 'text/html' });
                document.getElementById('myIframe').src = URL.createObjectURL(blob);
                
                addChatMessage('assistant', 'I\'ve updated the HTML file. You can preview the changes in the iframe above.');
            } else if (jsonResponse.chat_message) {
                addChatMessage('assistant', jsonResponse.chat_message);
            } else {
                addChatMessage('assistant', 'I received an unexpected response format. Please try again.');
            }
        } catch (e) {
            addChatMessage('assistant', 'There was an error processing the response. Please try again.');
        }
    } catch (error) {
        document.getElementById(loadingId)?.remove();
        addChatMessage('assistant', `Error: ${error.message}`);
    }
}

// Helper function to add messages to the chat
function addChatMessage(role, content, id = '') {
    const messageDiv = document.createElement('div');
    if (id) messageDiv.id = id;
    messageDiv.style.marginBottom = '8px';
    messageDiv.style.padding = '8px';
    messageDiv.style.borderRadius = '4px';
    messageDiv.style.backgroundColor = role === 'user' ? 'var(--bg-light)' : 'var(--primary)';
    messageDiv.style.color = role === 'user' ? 'var(--text-dark)' : 'white';
    messageDiv.style.alignSelf = role === 'user' ? 'flex-end' : 'flex-start';
    messageDiv.style.maxWidth = '80%';
    
    messageDiv.textContent = content;
    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

// Event listeners for chat
chatSend.addEventListener('click', sendChatMessage);
chatInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendChatMessage();
    }
});

// Initial welcome message
setTimeout(() => {
    addChatMessage('assistant', 'Hello! I can help you modify your web page. What changes would you like to make?');
}, 1000);

// Ensure chat starts minimized
if (!isChatMinimized) {
    chatbotHeader.click();
}


    </script>
</body>
</html>
