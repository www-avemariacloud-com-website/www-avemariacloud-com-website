<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Multi Model Chatbot v6.8</title>
    <link rel="icon" href="multi-model-ai-chatbot.png" type="image/x-icon">
    <style>
        html, body {
            height: 100vh;
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom right, #e0f7fa, #e3f2fd);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .header-section {
            padding: 10px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-section h1 {
            font-size: 1.25rem;
            color: #3f51b5;
            margin: 0;
        }

        .controls-container {
            display: flex;
            gap: 10px;
        }

        .custom-button {
            padding: 5px 10px;
            font-size: 0.875rem;
            color: white;
            background: linear-gradient(to right, #2196f3, #3f51b5);
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .custom-button:hover {
            opacity: 0.9;
        }

        .custom-select {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .chat-section {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 10px;
            overflow-y: auto;
        }

        .chat-container {
            flex-grow: 1;
            padding: 10px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            width: calc(100% - 20px);
        }

        .message {
            max-width: 100%;
            padding: 15px;
            margin: 10px 0;
            border-radius: 20px;
            word-wrap: break-word;
            white-space: pre-wrap;
            animation: fadeIn 0.3s ease-in;
            position: relative;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .assistant-message {
            background: #f0f0f0;
            color: #000;
            align-self: flex-start;
            border-top-left-radius: 0;
            border-left: 5px solid #3f51b5;
        }

        .user-message {
            background: #2196f3;
            color: white;
            align-self: flex-end;
            border-top-right-radius: 0;
            border-right: 5px solid #1976d2;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .footer-section {
            padding: 10px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .input-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        textarea {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            resize: none;
            min-height: 50px;
        }

        button {
            padding: 10px 15px;
            font-size: 0.875rem;
            color: white;
            background: linear-gradient(to right, #4caf50, #8bc34a);
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            opacity: 0.9;
        }

        .legal-notice {
            font-size: 0.75rem;
            color: #757575;
            margin-top: 10px;
        }

        .legal-notice a {
            color: #3f51b5;
            text-decoration: none;
        }

        .legal-notice a:hover {
            text-decoration: underline;
        }
        
        @media (max-width: 640px) {
            .controls-container {
                flex-direction: column;
                gap: 5px;
            }

            .custom-select {
                width: 100%;
            }

            .input-container {
                flex-direction: column;
            }

            textarea {
                width: 100%;
            }

            button {
                width: 100%;
            }
        }
        
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header-section">
            <h1>Multi Model Chatbot v6.8</h1>
            <div class="controls-container">
                <button class="custom-button" onclick="updateSystemPrompt('universal');">Universal</button>
                <button class="custom-button" onclick="updateSystemPrompt('zionism');">Zionism</button>
                <button class="custom-button" onclick="updateSystemPrompt('custom');">Custom</button>
                <select id="aiModel" class="custom-select">
                    <option value="gemma2-9b-it">Gemma 2 (9B)</option>
                    <option value="llama-3.2-90b-vision-preview" selected>Llama 3.2 (90B)</option>
                    <option value="mixtral-8x7b-32768">Mixtral 8x7B</option>
                </select>
            </div>
        </div>

        <div class="chat-section">
            <div class="chat-container" id="chatContainer">
                <div id="chatMessages">
                    <div class="message assistant-message">Welcome to AveMariaCloud!</div>
                </div>
            </div>
        </div>

        <div class="footer-section">
            <form id="chatForm" class="input-container">
                <textarea id="userInput" placeholder="Type your message..."></textarea>
                <button type="submit">Send</button>
            </form>

            <div class="legal-notice">
<p>
                © 2025 Internet Services LLC | AveMariaCloud.com<BR><BR>
                <a href="mailto:website@avemariacloud.com">website@avemariacloud.com</a>
                <BR><BR>
                Maybe you should read and agree to these <a href="https://avemariacloud.com/terms.html" target="_blank">Terms of Service</a> and this <a href="https://avemariacloud.com/privacy.html" target="_blank">Privacy Policy</a>.
                <br><br>
                Code may have been generated with the assistance of ChatGPT (OpenAI), Claude AI (Anthropic), Meta Llama 3 (Meta), Gemma (Google), and Mixtral (Mistral AI). Each of these tools may have contributed to different aspects of the code. You may benefit from consulting the terms of service and usage guidelines from OpenAI, Anthropic, Meta, Google, and Mistral AI for more information on the permitted usage and attribution requirements.
                <br><br>
                OpenAI (ChatGPT): You can access their <a href="https://openai.com/policies/terms-of-use/">Terms of Use</a>, <a href="https://openai.com/policies/row-privacy-policy/">Privacy Policy</a>, <a href="https://openai.com/brand/">Brand Guidelines</a>, and <a href="https://openai.com/policies/">General Policies</a>.<br>
                Anthropic (Claude AI): Relevant links include <a href="https://www.anthropic.com/legal/consumer-terms">Consumer Terms</a>, <a href="https://www.anthropic.com/legal/commercial-terms">Commercial Terms</a>, <a href="https://www.anthropic.com/legal/privacy">Privacy Policy</a>, <a href="https://www.anthropic.com/responsible-disclosure-policy">Responsible Disclosure Policy</a>, and their <a href="https://trust.anthropic.com/">Trust Center</a>.<br>
                Meta (Llama 3): Find their <a href="https://www.llama.com/llama3/use-policy/">Use Policy</a>, <a href="https://www.facebook.com/privacy/policy/">Privacy Policy</a>, and <a href="https://www.facebook.com/privacy/policies/cookies/?entry_point=cookie_policy_redirect&entry=0">Cookie Policy</a>.<br>
                Google (Gemma): Refer to their <a href="https://policies.google.com/terms">Terms of Service</a> and <a href="https://policies.google.com/privacy">Privacy Policy</a>.<br>
                Mistral AI (Mixtral): Their <a href="https://mistral.ai/terms">Terms of Service</a> are available online.
                <br><br>
                Some notices may be relevant.<br><br>
                <strong>Built with Meta Llama 3:</strong> This tool incorporates Meta Llama 3, which is licensed under the <a href="https://www.llama.com/llama3/license/" target="_blank">Meta Llama 3 Community License</a>. Copyright © Meta Platforms, Inc. All Rights Reserved.<br>
                <strong>Gemma:</strong> Gemma is provided under and subject to the Gemma Terms of Use found at <a href="https://ai.google.dev/gemma/terms">ai.google.dev/gemma/terms</a>.<br>
                <strong>Mixtral-8x7B License:</strong> Mixtral-8x7B is distributed under the <a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache 2.0 license</a>.<br>
                <strong><a href="https://avemariacloud.com/stability-ai-notice.txt">Notice</a>: Powered by Stability AI:</strong> This Stability AI Model is licensed under the <a href="https://stability.ai/community-license-agreement">Stability AI Community License</a>, Copyright ©  Stability AI Ltd. All Rights Reserved. Stability AI<br>
                <strong>Hugging Face API:</strong> This tool may use the Hugging Face API, and may be subject to their <a href="https://huggingface.co/terms-of-service" target="_blank">Terms of Service</a>, <a href="https://huggingface.co/privacy" target="_blank">Privacy Policy</a>, <a href="https://huggingface.co/content-guidelines">Content Guidelines</a>, and <a href="https://huggingface.co/code-of-conduct">Code of Conduct</a>.<br>
                <strong>Attribution Notice: FLUX.1 [dev] Model</strong> any rights to use the FLUX.1 [dev] Models and/or Derivatives shall be directly granted by Company to said third-party recipients pursuant to this <a href="https://huggingface.co/black-forest-labs/FLUX.1-dev/blob/main/LICENSE.md">License</a> "The FLUX.1 [dev] Model is licensed by Black Forest Labs. Inc. under the FLUX.1 [dev] Non-Commercial License. Copyright Black Forest Labs. Inc. IN NO EVENT SHALL BLACK FOREST LABS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH USE OF THIS MODEL." I may have have modified the applicable FLUX.1 [dev] Model. <a href="https://avemariacloud.com/flux.1-[dev]-notice.txt">FLUX.1 [dev] Model Notice</a>
            </p>
            </div>
        </div>
    </div>

    <script>

        function updateSystemPrompt(prompt) {


        









            


            if (prompt == "universal") {
                resetChatHistory("Welcome to AveMariaCloud!");
                conversationHistory = [
                    { role: "system", content: `I would like you to be a helpful AI chatbot for a Christian website.

I would like a very strong bias for caution and perfect information.

I would like you to always cite Scripture perfectly from the NIV translation of the bible in any circumstance, even if asked for other translations.

I would like you to always cite Scripture perfectly and in full 100% as it is in the NIV translation whenever you share any information in relation to Scripture.` },
                    { role: "assistant", content: "Welcome to AveMariaCloud!" }
                ];
            }
            if (prompt == "zionism") {
                resetChatHistory("Shalom!");
    
                conversationHistory = [
                    { role: "system", content: `I would like you to be a helpful AI chatbot for a Christian website.

I would like you to share information within the context of Christian Zionism.

I would like a very strong bias for caution and perfect information.

I would like you to always cite Scripture perfectly from the KJV translation of the bible in any circumstance, even if asked for other translations.

I would like you to always cite Scripture perfectly and in full 100% as it is in the KJV translation whenever you share any information in relation to Scripture.` },
                    { role: "assistant", content: "Shalom!" }
                ];
            }
            if (prompt == "custom") {
                var customPrompt = window.prompt("You can enter text for a system prompt");
    
                var systemPromptContent = `I would like you to be a helpful AI chatbot for a Christian website.

I would like a very strong bias for caution and perfect information.

I would like you to always cite Scripture perfectly from the NIV translation of the bible in any circumstance, even if asked for other translations.

I would like you to always cite Scripture perfectly and in full 100% as it is in the NIV translation whenever you share any information in relation to Scripture.

I would like you to use this information for a system prompt that may have been provided by a user` + customPrompt;
                
                resetChatHistory("Hello!");
    
                conversationHistory = [
                    { role: "system", content: systemPromptContent },
                    { role: "assistant", content: "Hello!" }
                ];
    
    
}







            









            
        }
    
        function resetChatHistory(startingMessage) {
            document.getElementById("chatMessages").innerHTML = `
                    <div class="message assistant-message">` + startingMessage + `</div>
                `;
        }

        const apiKey = "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";
        const apiUrl = "https://proxy.small-recipe-9582.workers.dev/";
        const chatMessages = document.getElementById('chatMessages');
        const chatForm = document.getElementById('chatForm');
        const userInput = document.getElementById('userInput');
        const aiModel = document.getElementById('aiModel');
    
        const TOKEN_LIMIT = 700; // Set your token limit here
        let conversationHistory = [
            { role: "system", content: `I would like you to be a helpful AI chatbot for a Christian website.

I would like a very strong bias for caution and perfect information.

I would like you to always cite Scripture perfectly from the NIV translation of the bible in any circumstance, even if asked for other translations.

I would like you to always cite Scripture perfectly and in full 100% as it is in the NIV translation whenever you share any information in relation to Scripture.`},
            { role: "assistant", content: "Welcome to AveMariaCloud!" }
        ];
    
        // Function to estimate token usage for a message
        function estimateTokens(message) {
            const words = message.split(/\s+/).length;
            return Math.ceil(words / 1.33); // Approximate 1.33 tokens per word
        }
    
        // Function to trim conversation history to stay within token limit
        function trimConversationHistory() {
            let totalTokens = conversationHistory.reduce((total, message) => total + estimateTokens(message.content), 0);
    
            console.log("total tokens, untrimmed:" + totalTokens);
            
            // Trim messages from the beginning if the total token count exceeds the limit
            while (totalTokens > TOKEN_LIMIT) {
                conversationHistory.shift();
                totalTokens = conversationHistory.reduce((total, message) => total + estimateTokens(message.content), 0);
                
                console.log("total tokens, trimmed:" + totalTokens);
            }
        }
    
        function scrollToBottom() {
            const chatContainer = document.querySelector('.chat-container');
            const chatMessages = document.getElementById('chatMessages');
            
            // Calculate the total scroll height
            const scrollHeight = chatMessages.scrollHeight;
            
            // Smooth scroll to bottom
            chatContainer.scrollTo({
                top: scrollHeight,
                behavior: 'smooth'
            });
            
            // Fallback scroll check to ensure we reach bottom
            setTimeout(() => {
                if (chatContainer.scrollTop + chatContainer.clientHeight < scrollHeight) {
                    chatContainer.scrollTop = scrollHeight;
                }
            }, 100);
        }
    
        function addMessage(content, role) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ` + role + `-message`;
            messageDiv.textContent = content;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }
    
        function addLoadingIndicator() {
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'message mr-auto bg-gray-100 text-gray-800 p-3 rounded-lg';
            loadingDiv.id = 'loadingIndicator';
            const loadingContent = document.createElement('span');
            loadingContent.className = 'loading-dots';
            loadingDiv.appendChild(loadingContent);
            chatMessages.appendChild(loadingDiv);
            scrollToBottom();
        }
    
        function removeLoadingIndicator() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            if (loadingIndicator) {
                loadingIndicator.remove();
            }
        }
    
        async function sendMessage(message) {
            try {
                // Trim conversation history to fit within the token limit
                trimConversationHistory();
    
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: aiModel.value,
                        messages: conversationHistory,
                        temperature: 0.7,
                        max_tokens: 1000
                    })
                });
    
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
    
                const data = await response.json();
                const aiResponse = data.choices[0].message.content;
                
                conversationHistory.push({ role: "assistant", content: aiResponse });
                removeLoadingIndicator();
                addMessage(aiResponse, 'assistant');
            } catch (error) {
                console.error('Error:', error);
                removeLoadingIndicator();
                addMessage("I apologize, but I encountered an error. Please try again.", 'assistant');
            }
        }
    
        function handleMessageSubmit(e) {
            if (e) e.preventDefault();
            const message = userInput.value;
            console.log(message);
            if (!message) return;
    
            addMessage(message, 'user');
            conversationHistory.push({ role: "user", content: message });
            userInput.value = '';
            addLoadingIndicator();
            sendMessage(message);
        }
    
        chatForm.addEventListener('submit', handleMessageSubmit);
    
        function isMobileDevice() {
            return /Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent);
        }
    
        userInput.addEventListener('keypress', (e) => {
            if (!isMobileDevice() && e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                handleMessageSubmit();
            }
        });
    
        userInput.focus();
    </script>
</body>
</html>
